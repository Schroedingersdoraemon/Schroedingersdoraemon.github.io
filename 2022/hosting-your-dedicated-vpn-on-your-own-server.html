<!doctype html><title>
Hosting your dedicated VPN on your own server
    </title><meta charset=utf-8><meta content=width=device-width initial-scale=1 name=viewport><link href=/theme/css/main.css rel=stylesheet><body><h1>Hosting your dedicated VPN on your own server</h1> 2022-04-28 23:16 <hr><h1>1. Prerequisite</h1><p>>=net-proxy/shadowsocks-libev-3.3.1<h1>2. Configuration</h1><p>The configuration file is usually located at <code>/etc/shadowsocks-libev/config.json</code><div class=highlight><pre><span></span><code><span class=p>{</span>
<span class=w>    </span><span class=err>#</span><span class=w> </span><span class=err>de</span><span class=kc>f</span><span class=err>i</span><span class=kc>ne</span><span class=w> </span><span class=err>li</span><span class=kc>nes</span><span class=w> </span><span class=err>s</span><span class=kc>tart</span><span class=err>i</span><span class=kc>n</span><span class=err>g</span><span class=w> </span><span class=err>wi</span><span class=kc>t</span><span class=err>h</span><span class=w> </span><span class=err>#</span><span class=w> </span><span class=err>as</span><span class=w> </span><span class=err>comme</span><span class=kc>nts</span>
<span class=w>    </span><span class=nt>"server"</span><span class=p>:[</span><span class=s2>"::0"</span><span class=p>,</span><span class=s2>"0,0,0,0"</span><span class=p>],</span>

<span class=w>    </span><span class=nt>"server_port"</span><span class=p>:</span><span class=mi>8388</span><span class=p>,</span>

<span class=w>    </span><span class=err>#</span><span class=w> </span><span class=kc>t</span><span class=err>he</span><span class=w> </span><span class=kc>f</span><span class=err>ollowi</span><span class=kc>n</span><span class=err>g</span><span class=w> </span><span class=err>me</span><span class=kc>t</span><span class=err>hod</span><span class=w> </span><span class=err>is</span><span class=w> </span><span class=err>o</span><span class=kc>ne</span><span class=w> </span><span class=err>o</span><span class=kc>f</span><span class=w> </span><span class=err>`AEAD</span><span class=w> </span><span class=err>ciphers`</span><span class=p>,</span><span class=w> </span><span class=err>which</span><span class=w> </span><span class=err>could</span><span class=w> </span><span class=err>resis</span><span class=kc>t</span><span class=w> </span><span class=err>probi</span><span class=kc>n</span><span class=err>g</span><span class=w> </span><span class=kc>fr</span><span class=err>om</span><span class=w> </span><span class=kc>t</span><span class=err>he</span><span class=w> </span><span class=err>GFW</span>
<span class=w>    </span><span class=err>#</span><span class=w> </span><span class=err>which</span><span class=w> </span><span class=err>i</span><span class=kc>n</span><span class=err>cludes</span><span class=w> </span><span class=err>`chacha</span><span class=mi>20-</span><span class=err>ie</span><span class=kc>tf</span><span class=mi>-</span><span class=err>poly</span><span class=mi>1305</span><span class=err>`</span><span class=p>,</span><span class=w> </span><span class=err>`aes</span><span class=mi>-256-</span><span class=err>gcm`</span><span class=p>,</span><span class=w> </span><span class=err>`aes</span><span class=mi>-128-</span><span class=err>gcm`</span>
<span class=w>    </span><span class=nt>"method"</span><span class=p>:</span><span class=s2>"chacha20-ietf-poly1305"</span><span class=p>,</span>


<span class=w>    </span><span class=err>#</span><span class=w> </span><span class=err>a</span><span class=w> </span><span class=err>much</span><span class=w> </span><span class=err>s</span><span class=kc>tr</span><span class=err>o</span><span class=kc>n</span><span class=err>ger</span><span class=w> </span><span class=err>password</span><span class=w> </span><span class=err>should</span><span class=w> </span><span class=err>be</span><span class=w> </span><span class=err>used</span>
<span class=w>    </span><span class=err>#</span><span class=w> </span><span class=err>you</span><span class=w> </span><span class=err>coulde</span><span class=w> </span><span class=err>use</span><span class=w> </span><span class=err>`ope</span><span class=kc>nssl</span><span class=w> </span><span class=err>ra</span><span class=kc>n</span><span class=err>d</span><span class=w> </span><span class=mi>-</span><span class=err>base</span><span class=mi>64</span><span class=w> </span><span class=mi>16</span><span class=err>`</span><span class=w> </span><span class=kc>t</span><span class=err>o</span><span class=w> </span><span class=err>ge</span><span class=kc>nerate</span><span class=w> </span><span class=err>a</span><span class=w> </span><span class=err>ra</span><span class=kc>n</span><span class=err>dom</span><span class=w> </span><span class=err>password</span>
<span class=w>    </span><span class=nt>"password"</span><span class=p>:</span><span class=s2>"*YourPassword*"</span><span class=p>,</span>

<span class=w>    </span><span class=nt>"mode"</span><span class=p>:</span><span class=s2>"tcp_and_udp"</span><span class=p>,</span>

<span class=w>    </span><span class=nt>"fast_open"</span><span class=p>:</span><span class=kc>false</span><span class=w> </span><span class=p>}</span>
</code></pre></div><h1>3. Fire Wall</h1><div class=highlight><pre><span></span><code># ufw allow ssh
# ufw allow 8388
# ufw enable
</code></pre></div><h1>4. Run</h1><div class=highlight><pre><span></span><code><span class=c1># start and enable the server daemon for systemd</span>
sudo<span class=w> </span>systemctl<span class=w> </span>start<span class=w> </span>shadowsocks-libev-server@.service
sudo<span class=w> </span>systemctl<span class=w> </span><span class=nb>enable</span><span class=w> </span>shadowsocks-libev-server@.service

<span class=c1># start and enable the server daemon for openrc</span>
sudo<span class=w> </span>rc-service<span class=w> </span>shadowsocks.server<span class=w> </span>start
sudo<span class=w> </span>rc-update<span class=w> </span>add<span class=w> </span>shadowsocks.server
</code></pre></div><h1>5. In case ...</h1><p>Redirect received traffic of both TCP and UDP ranges between 8389 and 8399 to 8388<div class=highlight><pre><span></span><code>sudo<span class=w> </span>iptables<span class=w> </span>-t<span class=w> </span>nat<span class=w> </span>-A<span class=w> </span>PREROUTING<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>--dport<span class=w> </span><span class=m>8389</span>:8399<span class=w> </span>-j<span class=w> </span>REDIRECT<span class=w> </span>--to-port<span class=w> </span><span class=m>8388</span>
sudo<span class=w> </span>iptables<span class=w> </span>-t<span class=w> </span>nat<span class=w> </span>-A<span class=w> </span>PREROUTING<span class=w> </span>-p<span class=w> </span>udp<span class=w> </span>--dport<span class=w> </span><span class=m>8389</span>:8399<span class=w> </span>-j<span class=w> </span>REDIRECT<span class=w> </span>--to-port<span class=w> </span><span class=m>8388</span>
</code></pre></div>